<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bootstrap demo</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-0evHe/X+R7YkIZDRvuzKMeqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
  <!-- Fontawesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
  <nav class="navbar navbar-expand-lg sticky-top shadow bg-info">
    <div class="container">
      <a class="navbar-brand" href="#"><i class="fa fa-ticket me-2"
          style="transform: rotate(-30deg) scale(1.2);"></i>Bagendit Ticketing |</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
        aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item">
            <a class="nav-link <%= (title == 'Home') ? 'active' : '' %>" aria-current="page" href="/dashboard"><i
                class="fa fa-house-chimney me-2"></i>Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (title == 'Home') ? 'active' : '' %>" aria-current="page" href="/dashboard"><i
                class="fa fa-ticket me-2" style="transform: rotate(-30deg)"></i>Order Ticket</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (title == 'Home') ? 'active' : '' %>" aria-current="page" href="/dashboard"><i
                class="fa fa-cart-arrow-down me-2"></i>Your Order</a>
          </li>
          <li class="nav-item">
            <a class="nav-link <%= (title == 'Home') ? 'active' : '' %>" aria-current="page" href="/login.html"><i
                class="fa fa-history me-2"></i>Order History</a>
          </li>

        </ul>
        <div class="collapse navbar-collapse d-flex justify-content-end" id="navbarNav">
          <img src="https://cloudflare-ipfs.com/ipfs/Qmd3W5DuhgHirLHGVixi6V76LhCkZUz6pnFt5AJBiyvHye/avatar/984.jpg"
            class="rounded-circle" width="30" alt="userPict">
          <ul class="navbar-nav">
            <li class="nav-item dropdown ">
              <a class="nav-link dropdown-toggle <%= (title == 'Home') ? 'active' : '' %> " href="#" id="navbarDropdown"
                role="button" data-bs-toggle="dropdown" aria-expanded="false">
                </i>Ackerman07 | Administrator
              </a>
              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li><a class="dropdown-item" href="#"><i class="fa fa-user-circle me-2"></i>Profil</a></li>
                <li>
                  <hr class="dropdown-divider">
                </li>
                <li><a class="dropdown-item" href="#"><i class="fa fa-sign-out me-2"></i>Logout</a></li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </nav>
  <div class="container p-0">
    <div class="row justify-content-center">
      <div class="col-md-10">
        <div class="card table-car shadow my-5 rounded-5">
          <div class="card-body py-3 px-3">
            <h4 class=" mb-5">
              <i class="fas fa-shopping-cart mx-2"></i> Your Order
            </h4>
            <div class="justify-content-end d-flex">
              <a href="{{ url('store') }}" class="btn btn-warning btn-sm"><i class="fas fa-plus me-1"></i>
                Add Order</a>
            </div>

            <div class="table-responsive">

              <table class="table">
                <thead class="bg-info text-center">
                  <th>No.</th>
                  <th>Tiket</th>
                  <th>Harga</th>
                  <th>Jumlah</th>
                  <th>Total Harga</th>
                  <th>Aksi</th>
                </thead>
                <tbody>

                  <!-- <?php
                  $i = 1;
                  ?>
                  @foreach($detail_order as $order) -->
                  <tr>
                    <td class="align-middle">{{ $i++ }}</td>
                    <td class="align-middle">{{ $order -> book -> title }}</td>
                    <td class="align-middle">Rp. {{ number_format($order -> book -> price) }}</td>
                    <td class="align-middle">{{ $order -> quantity }}</td>
                    <td class="align-middle">Rp. {{ number_format($order -> total_price) }}</td>
                    <td class="align-middle">
                      <form action="{{ url('checkout/remove',[$order -> id]) }}" method="post"
                        id="remove-order-{{ $order -> id }}">
                        @csrf
                        {{ method_field('DELETE') }}
                        <button class="btn btn-danger btn-sm delete-order warn-notif" data-msg="remove this order..?"
                          data-form="remove-order-{{ $order -> id }}">
                          <i class="fas fa-trash me-1"></i>Remove</button>

                      </form>
                    </td>
                  </tr>
                  @endforeach
                  <tr>
                    <th></th>
                    <th colspan="3" class="text-success">Total Pay</th>
                    <th class="text-success">
                      Rp. {{ number_format($order -> order -> total_price) }}
                    </th>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="text-center pt-6">
              <form action="{{ url('checkout/confirm') }}" id="checkout">
                @csrf
              </form>
              <button type="submit" class="btn btn-info warn-notif" data-form="checkout"
                data-msg="checkout your orders now..?">
                <i class="fa fa-cart-arrow-down me-2"></i>Checkout</button>


              <button onclick="window.history.back()" class="btn btn-secondary">
                <i class="fas fa-backward me-2"></i>Back</button>
            </div>
          </div>
        </div>

        <div class="card table-card shadow mb-6 rounded-5">
          <div class="card-body py-3 px-3">
            <h4 class="pt-1">
              <i class="fas fa-history mx-2"></i>Order History
            </h4>

            <div class="table-responsive">

              <table class="table  my-5" id="dataTable">
                <thead class="bg-info text-center">

                  <th>No.</th>
                  <th>Tanggal Pesan</th>
                  <th>Jumlah Tiket</th>
                  <th>Total Harga</th>
                  <th>Status</th>
                  <th>Aksi</th>
                </thead>
                <tbody class="text-center">
                  <!-- <?php
                  $i = 1;
                  ?>
                  @foreach($orders as $order) -->
                  <tr>
                    <td>{{ $i++ }}</td>
                    <td>{{ $order -> date }}</td>
                    <td>{{ $total_item[($i-2)] }}</td>
                    <td>Rp. {{ number_format($order -> total_price + $order ->payment_id) }}</td>
                    <th>

                      <!-- @if($order ->status == 1) -->
                      <span class="badge rounded-pill text-bg-success"><i class="fa fa-check-circle me-1"></i>
                        Paid</span>
                      <!-- @else
                      <span class="badge rounded-pill badge-danger"><i class="fa fa-close-circle me-1"></i> Unpaid</span>
                      @endif -->

                    </th>
                    <td>
                      <a href="{{ url('history', [$order ->id]) }}" class="btn btn-info btn-sm">
                        <i class="fas fa-info-circle"></i> Details
                      </a>
                    </td>
                  </tr>
                  @endforeach
                </tbody>
              </table>

            </div>
          </div>


          <div class="text-center mb-3">
            <a href="{{ url('store') }}" class="btn btn-secondary ms-auto"><i class="fa fa-store me-2"></i>Kembali ke
              Beranda</a>
          </div>
        </div>

        <div class="card table-card shadow mb-6">
          <div class="card-body py-5 px-3">
            <h4 class="pt-1 mb-5">
              <i class="fas fa-shopping-cart mx-2"></i> Detail Pemesanan
              </h2>

              <!-- @if($order ->status != 1)
            <div class="alert alert-success" role="alert">
              <span class="alert-icon"><i class="fa fa-info-circle me-2"></i> Success!</span>
              <span class="alert-text">Your orders have been confirmed,
                please complete the payment with a nominal value of
                <b>Rp. {{ number_format($order ->total_price + $order ->payment_id) }}</b>
                to account number <b>38-2918-1018</b> in the name of <b>Annie Leonhart</b></span>
            </div>
            @endif -->

              <span class="badge rounded-pill text-bg-warning mb-4"
                style="font-size: 0.8rem; text-transform: capitalize;">
                <b><i class="ni ni-calendar-grid-58 me-2"></i>
                  Tanggal Pesan : {{ $order ->date }}</b>
              </span>

              <a href="{{ url('history/print', $order ->id) }}" target="_blank"
                class="badge rounded-pill text-bg-primary ms-3 text-decoration-none {{ ($order ->status == 1) ? '' : 'd-none' }}"
                style="color: #e9ecef; font-size: 0.8rem; text-transform: capitalize;">
                <i class="fa fa-print me-2"></i>Cetak Tiket
              </a>


              <div class="table-responsive">
                <table class="table table-bordered">
                  <thead class="bg-info text-dark text-center">

                    <th>No.</th>
                    <th>Tiket</th>

                    <th>Harga</th>
                    <th>Jumlah</th>
                    <th>Total Harga</th>
                  </thead>
                  <tbody>
                    <!-- <?php
                $i = 1;
                ?>
                  @foreach($detail_orders as $detail_order) -->
                    <tr>
                      <td>{{ $i++ }}</td>
                      <td>{{ $detail_order -> book -> title }}</td>
                      <td>Rp. {{ number_format($detail_order -> book -> price) }}</td>
                      <td>{{ $detail_order -> quantity }}</td>
                      <td>Rp. {{ number_format($detail_order -> total_price) }}</td>
                    </tr>
                    <!-- @endforeach -->
                    <tr>
                      <td></td>
                      <th colspan="3">Total Harga</th>
                      <td>
                        Rp. {{ number_format($order ->total_price) }}
                      </td>
                    </tr>
                    <tr>
                      <td></td>
                      <th colspan="3">Kode Pembayaran</th>
                      <td>
                        Rp. {{ number_format($order ->payment_id) }}
                      </td>
                    </tr>
                    <tr>
                      <td></td>
                      <th colspan="3" class="text-success">Total Bayar</th>
                      <th class="text-success">
                        Rp. {{ number_format($order ->total_price + $order ->payment_id) }}
                      </th>
                    </tr>
                    <tr>
                      <td></td>
                      <th colspan="3">Status</th>
                      <th>
                        <!-- @if($order ->status == 1)
                      <span class="badge rounded-pill badge-success"><i class="fa fa-check-circle me-1"></i> Paid</span>
                      @else -->
                        <span class="badge rounded-pill bg-danger"><i class="fa fa-exclamation-circle me-1"></i>
                          Unpaid</span>
                        <!-- @endif -->

                      </th>
                    </tr>
                  </tbody>
                </table>

              </div>
          </div>


          <div class="text-center mb-3">
            <a href="{{ url('store') }}" class="btn btn-secondary ms-auto"><i class="fa fa-store me-2"></i>Kembali ke Beranda</a>
          </div>
        </div>

      </div>
    </div>

  </div>
  </div>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous">
  </script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"
    integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="https://cdn.datatables.net/1.12.1/js/jquery.dataTables.min.js"></script>
  <script src="https://cdn.datatables.net/1.12.1/js/dataTables.bootstrap4.min.js"></script>
  <script>
    $(document).ready(function () {
      $('#dataTable').DataTable();
    });
  </script>
</body>

</html>